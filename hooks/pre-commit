set -e

cd $(git rev-parse --show-toplevel)

# pull remote changes
git pull 

# update lock
nix flake update

# check config can be built
nixos-rebuild build

git add flake.nix && git add flake.lock
